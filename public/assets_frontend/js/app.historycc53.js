app.history={list:{},tv:{},order:[],init:function(){try{var t=localStorage.getItem("history-data"),i=localStorage.getItem("history-tv"),r=localStorage.getItem("history-order");app.history.list=t?JSON.parse(t):{},app.history.tv=i?JSON.parse(i):{},app.history.order=r?JSON.parse(r):[]}catch(t){console.log(t.message)}},add:function(t){t instanceof Array&&t.forEach(function(t){if(t.id){var i,r={};for(i in t)r[i]=t[i];app.history.order.unshift([r.id,r.info||r.year,r.image]),delete r.image,delete r.info,delete r.subtitles,"tv"==r.section&&delete r.torrent,app.history.list[r.id]=r}}),this.save()},remove:function(){},tv_episode:function(t){this.tv[t]?delete this.tv[t]:this.tv[t]=1,this.save()},save:function(){if(50<this.order.length){for(var t={},i=[],r=0;r<50;r++)i.push(this.order[r]),t[this.order[r]]=this.list[this.order[r]];this.order=i,this.list=t}try{localStorage.setItem("history-data",JSON.stringify(app.history.list)),localStorage.setItem("history-tv",JSON.stringify(app.history.tv)),localStorage.setItem("history-order",JSON.stringify(app.history.order))}catch(t){}},show:function(t){$("#history_panel .scroller").html(""),app.history.order.forEach(function(t){ui.home.catalog.items[t[0]]||(ui.home.catalog.items[t[0]]=app.history.list[t[0]]),$('<div class="item" data-id="'+t[0]+'" data-section="'+app.history.list[t[0]].section+'"><div class="image" style="background-image:url('+t[2]+')"></div><div class="title">'+app.history.list[t[0]].title+'</div><div class="info">'+t[1]+"</div></div>").appendTo("#history_panel .scroller").click(function(){ui[$(this).data("section")].show($(this).data("id"))})}),$("#history_panel").show(),$("#history_panel .scroller").width(140*$("#history_panel .item").length),app.history.scroller?app.history.scroller.refresh():app.history.scroller=new IScroll("#history_cont .incont",{mouseWheel:!0,mouseWheelSpeed:30,scrollbars:!0,scrollX:!0,scrollY:!1,click:!0,fadeScrollbars:!0,interactiveScrollbars:!0,resizeScrollbars:!0,shrinkScrollbars:"scale"})}};