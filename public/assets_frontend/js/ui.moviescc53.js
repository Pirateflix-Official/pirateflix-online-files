ui.movies={session:{},show:function(i){var e=ui.home.catalog.items[i];if(e){let i;const s=this.slider(e),t=this.handlers[app.config.fetcher.mode];for(i in ui.movies.session={id:e.id,title:e.title,info:e.year,year:e.year,image:e.poster_big,section:"movies"},this.set_torrents(e),this.get_subs(e),this.construct(e),t)t[i](e);s.show(),setTimeout(function(){app.state="movie"},100)}else logger.log("error_missing_movie_catalog_id_"+i)},slider:function(i){if(!$(".slider_"+i.id).length){ui.sliders.close_all();var e=utils.tokenizer(i,$("#movie_slider_html").html());return slider=new ui.slider("movie","fadein"),slider.destruct=function(){app.state="mainWindow"},slider.el.append(e).addClass("movie_"+i.id),slider}},watch:function(i){Mousetrap.pause(),torrentsTime.pt.setup.vpnShowed=!1,app.torrent.get(this.session);const e=ui.movies.session;e.torrents=ui.home.catalog.items[this.session.id].torrents,app.history.add([e])},set_torrents:function(i){const s=$("#slider_movie.movie_"+i.imdb+" .torrent_selector .selector_cont");s.html(""),i.torrents instanceof Array&&i.torrents.length?(i.torrents.forEach(function(i,e){0==e&&(ui.movies.session.torrent={url:i.torrent_url,magnet:i.torrent_magnet,file:i.file,quality:i.quality}),$('<div class="item torrent '+(0==e?"activated":"")+" "+i.quality.toLowerCase()+'" data-idx="'+e+'" data-quality="'+i.quality.toLowerCase()+'"><div class="icon2 baterry '+utils.calculateTorrentHealth(i.torrent_seeds,i.torrent_peers)+'"></div><div class="caption">'+i.torrent_seeds+"/"+i.torrent_peers+" Peers</div></div>").appendTo(s).click(function(){$(".item.torrent.activated").removeClass("activated"),$(this).addClass("activated");var i=ui.home.catalog.items[ui.movies.session.id].torrents[parseInt($(this).data("idx"))];ui.movies.session.torrent={url:i.torrent_url,magnet:i.torrent_magnet,file:i.file,quality:i.quality}})}),$("#slider_movie .quality_selector").click(function(){$(this).hasClass("enabled")&&($("#slider_movie .quality_selector.activated").removeClass("activated"),$(this).addClass("activated"),$("#slider_movie .torrent").removeClass("activated").hide(),$("#slider_movie .torrent."+$(this).data("quality")).show().first().click())}),i=$("#slider_movie .torrent").first().data("quality"),$("#slider_movie .quality_selector").each(function(){$("#slider_movie .torrent."+$(this).data("quality")).length&&$(this).addClass("enabled")}),$("#slider_movie .quality_selector."+i).click()):s.html('<div class="item"><div class="caption">No torrents</div></div>')},get_subs:function(s){function r(i){n.html('<div class="item subtitle"><div class="icon2 lang"></div><div class="caption">'+(i||locale.translate("subtitledIn"))+"</div></div>")}var n=$("#slider_movie.movie_"+s.imdb+" .subs_selector .selector_cont");ui.movies.session.subtitles=[],r(),fetcher.scrappers.ysubs(s.imdb,function(i){for(var o=[],e=0;e<i.length;e++)o.push(i[e]);fetcher.scrappers.torrentsapi_subs_movie(s.imdb,function(i){for(var e=0;e<i.length;e++)o.push(i[e]);if(!o instanceof Array||!o.length)r("No &nbsp;Subtitles");else{ui.movies.session.subtitles=[];const t={};r();for(var s,e=0;e<o.length;e++)t[o[e][1]]||(t[o[e][1]]=!0,(s=o[e][1]==app.config.locale.preferredSubs)&&(ui.movies.session.subtitles_locale=o[e][1]),$('<div data-locale="'+o[e][1]+'" class="item subtitle '+(s?"activated":"")+'"><div class="caption"><img src="css/images/flags/'+(resource.lang2code[o[e][1]]||"xx")+'.png" class="flag" onload="this.style.visibility=\'visible\'">'+(locale.langs[o[e][1]]||o[e][2])+"</div></div>")[s?"prependTo":"appendTo"](n).click(function(){$(".item.subtitle.activated").removeClass("activated"),$(this).addClass("activated"),app.config.set({locale:{preferredSubs:$(this).data("locale")}}),ui.tv.session.subtitles_locale=$(this).data("locale")}),ui.movies.session.subtitles.push(o[e]))}})})},construct:function(i){var e=void 0!==app.favs.list[i.id];$("#slider_movie.movie_"+i.id+" .js-add-favorite").click(function(){app.favs.toggle(i.id)}).toggleClass("infavs",e),i.trailer&&$("#slider_movie.movie_"+i.id+" .trailer").show().click(function(){ui.trailer.show(i.trailer)}),i.streaming&&$("#slider_movie.movie_"+i.id+" .watch-btn").show().click(function(){ui.streaming.show(i.streaming)}),$("#slider_movie.movie_"+i.id+" .js-play").show().click(function(){ui.streaming.show(i.streaming)})},getTrailer:function(s){ui.movies.infoXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+s.tmdb_id+"/videos?api_key="+app.config.api_keys.tmdb,function(i){let e;i&&i.results.length&&((e=!!i.results[0].key&&"https://www.youtube.com/embed/"+i.results[0].key+"?autoplay=1")&&$("#slider_movie.movie_"+s.id+" .trailer").show().click(function(){ui.trailer.show(e)}),s.trailer=e)},"json")},getStreaming:function(s){ui.movies.infoXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+s.tmdb_id+"/videos?api_key="+app.config.api_keys.tmdb,function(i){let e;i&&i.results.length&&((e="https://www.2embed.ru/embed/tmdb/movie?id="+s.tmdb_id)&&$("#slider_movie.movie_"+s.id+" .watch-btn").show().click(function(){ui.streaming.show(e)}),$("#slider_movie.movie_"+s.id+" .js-play").show().click(function(){ui.streaming.show(s.streaming)}),s.streaming=e)},"json")},handlers:{imdb:{get_movie_info:function(s){function e(){$(".slider.movie_"+s.imdb+" .synopsis").html(s.synopsis).addClass("fadein"),$(".slider.movie_"+s.imdb+" .title_info .runtime").html(s.runtime),$(".slider.movie_"+s.imdb+" .title_info.genre").html(s.genre),$(".slider.movie_"+s.imdb+" .player").attr("href","https://www.2embed.ru/embed/tmdb/movie?id="+s.imdb),$(".slider.movie_"+s.imdb+' .player[rel="modal"]').modalBox(),$(".slider.movie_"+s.imdb+" .title_info.stars").attr("title",s.voteAverage+" / 10").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+s.imdb_id)}).children("span").css({cursor:"pointer"}),$(".slider.movie_"+s.imdb+" .js-review").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+s.imdb_id+"/reviews")}).css({cursor:"pointer"}),$(".slider.movie_"+s.imdb+" .js-synopsis").html(s.synopsis),$(".slider.movie_"+s.imdb+" .js-runtime").html(s.runtime),$(".slider.movie_"+s.imdb+" .js-genres").html(s.genre),$(".slider.movie_"+s.imdb+" .js-rating").attr("title",s.voteAverage+" / 10").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+s.imdb_id)}).children("span").css({cursor:"pointer"});var i=app.config.api_keys.tmdb_src+"w500"+s.poster_path,e=s.title.toLowerCase().replace(/\s\(\d{4}\)$/,"");utils.setMetas({title:utils.titles.itemTitle.replace("{{item_name}}",s.title),url:"https://popcorntimeonline.xyz/"+slugify(e+" "+s.year)+".html?imdb="+s.imdb_id,image:i})}ui.movies.infoXHR&&"function"==typeof ui.movies.infoXHR.abort&&ui.movies.infoXHR.abort(),s.synopsis&&s.runtime&&s.genre?setTimeout(e,100):ui.movies.infoXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+s.imdb+"?api_key="+app.config.api_keys.tmdb+"&append_to_response=external_ids,videos,images,keywords,credits",function(i){i&&(s.tmdb_id=i.id,s.poster_path=i.poster_path,s.imdb_id=i.external_ids.imdb_id,s.synopsis=i.overview,s.runtime=i.runtime+" "+locale.translate("durationUnit"),s.genre=i.genres instanceof Array&&i.genres[0]&&i.genres[0].name||"",s.trailer||ui.movies.getTrailer(s),s.streaming||ui.movies.getStreaming(s)),e()},"json")},load_images:function(r){ui.movies.imgsXHR&&"function"==typeof ui.movies.imgsXHR.abort&&ui.movies.imgsXHR.abort(),ui.movies.imgsXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+r.imdb+"/images?api_key="+app.config.api_keys.tmdb+"&append_to_response=external_ids,videos,images",function(o){let s=r.poster_big;if("object"==typeof o){if(o.posters)for(let i=!1,e=0;e<o.posters.length;e++)if(1080<o.posters[e].height){if(o.posters[e].iso_639_1==locale.language){s=app.config.api_keys.tmdb_src+"w780"+o.posters[e].file_path;break}i||"en"!=o.posters[e].iso_639_1||(s=app.config.api_keys.tmdb_src+"w780"+o.posters[e].file_path,i=!0)}o.videos&&console.log(o.videos);const t=new Image;t.onload=function(){clearTimeout(i),$("#slider_movie.movie_"+r.id+" .poster_img").attr("src",s).addClass("fadein"),$("#slider_movie.movie_"+r.id+" .js-poster").css("background-image","-webkit-linear-gradient(rgba(0,0,0, 0) 0%,rgba(0,0,0, 1) 100%), url("+r.poster_big+")").addClass("fadein"),setTimeout(e,2222)},t.src=s;var i=setTimeout(function(){e()},5e3),e=function(){let t;o.backdrops instanceof Array&&(t=function(i){let e,s;$(".movie_"+r.id).length&&(i>=o.backdrops.length&&(i=0,!$("#slider_movie.movie_"+r.id+" .backdrop_img").length)||(1920==(s=o.backdrops[i]).width?(e=app.config.api_keys.tmdb_src+"w1280"+s.file_path,(s=new Image).onload=function(){ui.movies.session.image=e.replace("w1280","w185"),$('<div class="backdrop_img"><div class="img" style="background-image:url('+e+')">').appendTo("#slider_movie .backdrop"),$("#slider_movie .backdrop_img.fadein").fadeOut("slow",function(){$(this).remove()}),setTimeout(function(){$("#slider_movie .backdrop_img").last().addClass("fadein"),setTimeout(function(){t(++i)},6750)},10)},s.src=e):setTimeout(function(){t(++i)},500)))})(0)}}},"json")},load_actors:function(i){}},anime:{get_movie_info:function(e){function s(){$(".slider.movie_"+e.imdb+" .synopsis").html(e.synopsis).addClass("fadein"),$(".slider.movie_"+e.imdb+" .title_info .runtime").html(e.runtime),$(".slider.movie_"+e.imdb+" .title_info.genre").html("Anime"),$(".slider.movie_"+e.imdb+" .player").attr("href","https://www.2embed.ru/embed/tmdb/movie?id="+e.imdb),$(".slider.movie_"+e.imdb+' .player[rel="modal"]').modalBox(),$(".slider.movie_"+e.imdb+" .title_info.stars").attr("title",e.voteAverage+" / 10").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+e.imdb_id)}).children("span").css({cursor:"pointer"}),$(".slider.movie_"+e.imdb+" .js-review").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+e.imdb_id+"/reviews")}).css({cursor:"pointer"}),$(".slider.movie_"+e.imdb+" .js-synopsis").html(e.synopsis),$(".slider.movie_"+e.imdb+" .js-runtime").html(e.runtime),$(".slider.movie_"+e.imdb+" .js-genres").html(e.genre),$(".slider.movie_"+e.imdb+" .js-rating").attr("title",e.voteAverage+" / 10").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+e.imdb_id)}).children("span").css({cursor:"pointer"})}ui.movies.infoXHR&&"function"==typeof ui.movies.infoXHR.abort&&ui.movies.infoXHR.abort(),e.synopsis&&e.runtime&&e.genre?setTimeout(s,100):ui.movies.infoXHR=$.get("https://api.themoviedb.org/3/movie/"+e.imdb+"?api_key="+app.config.api_keys.tmdb+"&append_to_response=external_ids,videos,images",function(i){i&&(e.tmdb_id=i.id,e.imdb_id=i.external_ids.imdb_id,e.synopsis=i.overview,e.runtime=i.runtime+" "+locale.translate("durationUnit"),e.genre=i.genres instanceof Array&&i.genres[0]&&i.genres[0].name||"",e.trailer||ui.movies.getTrailer(e)),s()},"json")},load_images:function(r){ui.movies.imgsXHR&&"function"==typeof ui.movies.imgsXHR.abort&&ui.movies.imgsXHR.abort(),ui.movies.imgsXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+r.imdb+"/images?api_key="+app.config.api_keys.tmdb,function(o){let s=r.poster_big;if("object"==typeof o){if(o.posters)for(let i=!1,e=0;e<o.posters.length;e++)if(1080<o.posters[e].height){if(o.posters[e].iso_639_1==locale.language){s=app.config.api_keys.tmdb_src+"w780"+o.posters[e].file_path;break}i||"en"!=o.posters[e].iso_639_1||(s=app.config.api_keys.tmdb_src+"w780"+o.posters[e].file_path,i=!0)}o.videos&&console.log(o.videos);const t=new Image;t.onload=function(){clearTimeout(i),$("#slider_movie.movie_"+r.id+" .poster_img").attr("src",s).addClass("fadein"),$("#slider_movie.movie_"+r.id+" .js-poster").css("background-image","-webkit-linear-gradient(rgba(0,0,0, 0) 0%,rgba(0,0,0, 1) 100%), url("+r.poster_big+")").addClass("fadein"),setTimeout(e,2222)},t.src=s;var i=setTimeout(function(){e()},5e3),e=function(){let t;o.backdrops instanceof Array&&(t=function(i){let e,s;$(".movie_"+r.id).length&&(i>=o.backdrops.length&&(i=0,!$("#slider_movie.movie_"+r.id+" .backdrop_img").length)||(1920==(s=o.backdrops[i]).width?(e=app.config.api_keys.tmdb_src+"w1280"+s.file_path,(s=new Image).onload=function(){ui.movies.session.image=e.replace("w1280","w185"),$('<div class="backdrop_img"><div class="img" style="background-image:url('+e+')">').appendTo("#slider_movie .backdrop"),$("#slider_movie .backdrop_img.fadein").fadeOut("slow",function(){$(this).remove()}),setTimeout(function(){$("#slider_movie .backdrop_img").last().addClass("fadein"),setTimeout(function(){t(++i)},6750)},10)},s.src=e):setTimeout(function(){t(++i)},500)))})(0)}}},"json")}},cartoons:{get_movie_info:function(e){function s(){$(".slider.movie_"+e.imdb+" .synopsis").html(e.synopsis).addClass("fadein"),$(".slider.movie_"+e.imdb+" .title_info .runtime").html(e.runtime),$(".slider.movie_"+e.imdb+" .title_info.genre").html("Cartoons"),$(".slider.movie_"+e.imdb+" .player").attr("href","https://www.2embed.ru/embed/tmdb/movie?id="+e.imdb),$(".slider.movie_"+e.imdb+' .player[rel="modal"]').modalBox(),$(".slider.movie_"+e.imdb+" .title_info.stars").attr("title",e.voteAverage+" / 10").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+e.imdb_id)}).children("span").css({cursor:"pointer"}),$(".slider.movie_"+e.imdb+" .js-review").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+e.imdb_id+"/reviews")}).css({cursor:"pointer"}),$(".slider.movie_"+e.imdb+" .js-synopsis").html(e.synopsis),$(".slider.movie_"+e.imdb+" .js-runtime").html(e.runtime),$(".slider.movie_"+e.imdb+" .js-genres").html(e.genre),$(".slider.movie_"+e.imdb+" .js-rating").attr("title",e.voteAverage+" / 10").click(function(){hostApp.openBrowser("https://www.imdb.com/title/"+e.imdb_id)}).children("span").css({cursor:"pointer"})}ui.movies.infoXHR&&"function"==typeof ui.movies.infoXHR.abort&&ui.movies.infoXHR.abort(),e.synopsis&&e.runtime&&e.genre?setTimeout(s,100):ui.movies.infoXHR=$.get("https://api.themoviedb.org/3/movie/"+e.imdb+"?api_key="+app.config.api_keys.tmdb+"&append_to_response=external_ids,videos,images",function(i){i&&(e.tmdb_id=i.id,e.imdb_id=i.external_ids.imdb_id,e.synopsis=i.overview,e.runtime=i.runtime+" "+locale.translate("durationUnit"),e.genre=i.genres instanceof Array&&i.genres[0]&&i.genres[0].name||"",e.trailer||ui.movies.getTrailer(e)),s()},"json")},load_images:function(r){ui.movies.imgsXHR&&"function"==typeof ui.movies.imgsXHR.abort&&ui.movies.imgsXHR.abort(),ui.movies.imgsXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+r.imdb+"/images?api_key="+app.config.api_keys.tmdb,function(o){let s=r.poster_big;if("object"==typeof o){if(o.posters)for(let i=!1,e=0;e<o.posters.length;e++)if(1080<o.posters[e].height){if(o.posters[e].iso_639_1==locale.language){s=app.config.api_keys.tmdb_src+"w780"+o.posters[e].file_path;break}i||"en"!=o.posters[e].iso_639_1||(s=app.config.api_keys.tmdb_src+"w780"+o.posters[e].file_path,i=!0)}o.videos&&console.log(o.videos);const t=new Image;t.onload=function(){clearTimeout(i),$("#slider_movie.movie_"+r.id+" .poster_img").attr("src",s).addClass("fadein"),$("#slider_movie.movie_"+r.id+" .js-poster").css("background-image","-webkit-linear-gradient(rgba(0,0,0, 0) 0%,rgba(0,0,0, 1) 100%), url("+r.poster_big+")").addClass("fadein"),setTimeout(e,2222)},t.src=s;var i=setTimeout(function(){e()},5e3),e=function(){let t;o.backdrops instanceof Array&&(t=function(i){let e,s;$(".movie_"+r.id).length&&(i>=o.backdrops.length&&(i=0,!$("#slider_movie.movie_"+r.id+" .backdrop_img").length)||(1920==(s=o.backdrops[i]).width?(e=app.config.api_keys.tmdb_src+"w1280"+s.file_path,(s=new Image).onload=function(){ui.movies.session.image=e.replace("w1280","w185"),$('<div class="backdrop_img"><div class="img" style="background-image:url('+e+')">').appendTo("#slider_movie .backdrop"),$("#slider_movie .backdrop_img.fadein").fadeOut("slow",function(){$(this).remove()}),setTimeout(function(){$("#slider_movie .backdrop_img").last().addClass("fadein"),setTimeout(function(){t(++i)},6750)},10)},s.src=e):setTimeout(function(){t(++i)},500)))})(0)}}},"json")}}}};