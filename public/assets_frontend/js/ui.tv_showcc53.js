ui.tv={session:{},show:function(s){var e=ui.home.catalog.items[s];if(e){let s;const t=this.slider(e),i=this.handlers[app.config.fetcher.mode];for(s in this.construct(e),i)i[s](e);t.show(),setTimeout(function(){app.state="tvshow"},100)}else logger.log("error_missing_movie_catalog_id_"+s)},slider:function(s){if(!$(".tvshow_"+s.id).length){ui.sliders.close_all();var e=utils.tokenizer(s,$("#tvshow_slider_html").html());return slider=new ui.slider("tvshow","fadein"),slider.destruct=function(){app.state="mainWindow"},slider.el.append(e).addClass("tvshow_"+s.id),slider}},set_season:function(n,d){var s="https://api.themoviedb.org/3/tv/"+n+"/season/"+d+"?api_key=7ac6de5ca5060c7504e05da7b218a30c&append_to_response=keywords,external_ids";const e=$("#slider_tvshow.tvshow_"+n+" .episodes"),r=$("#slider_tvshow.tvshow_"+n+" .js-episodes");$("#slider_tvshow .row.season.activated").removeClass("activated"),$('#slider_tvshow .row.season[data-season="'+d+'"]').addClass("activated"),$('#slider_tvshow .row.season[data-season="0"]').hide(),$('#slider_tvshow .tvshow-seasons option[value="0"]').remove(),e.html('<div class="scroller_cont"></div>'),r.html(""),r.off("change"),r.on("change",function(){var s=$(this).find(":selected").data("id"),e=$(this).find(":selected").data("season_id"),t=$(this).find(":selected").data("episode_num");ui.tv.show_episode(s,e,t)}),$.getJSON(s,function(e){for(let s=0;s<e.episodes.length;s++){var t=e.episodes[s].episode_number,i=e.episodes[s].episode_number,o=e.episodes[s].name,a=(e.episodes[s].overview,e.episodes[s].air_date,app.history.tv[n+"_"+d+"_"+t]);$('<div onclick="ui.tv.show_episode('+n+", "+d+", "+t+');" data-episode_id="'+i+'" data-episode_num="'+t+'" class="row episode '+(a?"watched":"")+'"><span class="episode_num">'+t+'</span> &nbsp; &nbsp; <span class="episode_title">'+o+'</span><div class="pseudo_click_listener"></div></div>').appendTo("#slider_tvshow.tvshow_"+n+" .episodes .scroller_cont").click(function(s){var e=this;if($(s.target).hasClass("pseudo_click_listener"))return-1<e.className.indexOf("watched")?e.className=e.className.replace("watched",""):e.className+=" watched",void app.history.tv_episode(n+"_"+d+"_"+$(e).data("episode_id"));$("#slider_tvshow .row.episode.activated").removeClass("activated"),$(e).addClass("activated")}),r.append('<option value="'+n+", "+d+", "+t+'" data-id="'+n+'" data-season_id="'+d+'" data-episode_num="'+t+'">'+o+"</option>")}}),((s=$("#slider_tvshow .episode.watched").last().next()).length?s:$('#slider_tvshow .row.episode[data-episode_num="1"]')).click()},show_episode:function(n,s,e){ShowAPI="https://api.themoviedb.org/3/tv/"+n+"/season/"+s+"/episode/"+e+"?api_key=7ac6de5ca5060c7504e05da7b218a30c&append_to_response=keywords,external_ids",$.getJSON(ShowAPI,function(s){var e=s.name,t=s.episode_number,i=s.overview,o=s.season_number,a=(s.air_date,"//image.tmdb.org/t/p/w1280"+s.still_path),o=(s.vote_average,"https://vidsrc.to/embed/tv/"+n+"/"+o+"/"+t);$("#slider_tvshow .episode_name").html(e),$("#slider_tvshow .episode_number").html(locale.translate("episode")+" "+t),$("#slider_tvshow .episode_overview").html(i),$("#slider_tvshow .data").html(locale.translate("episode")+" "+t),$("#slider_tvshow.tvshow_"+n+" .backdrop .img").attr("style",'background-image: url("'+a+'")').removeClass("fadein").addClass("fadein"),$("#slider_tvshow.tvshow_"+n+" .watch-btn").attr("href",o),$("#slider_tvshow.tvshow_"+n+" .controls__play.player").attr("href",o),$("#slider_tvshow.tvshow_"+n+' .player[rel="modal"]').modalBox()})},watch:function(s){Mousetrap.pause(),torrentsTime.pt.setup.vpnShowed=!1,app.torrent.get(this.session),app.history.add([this.session]),app.history.tv_episode([[this.session.id,this.session.season_id,this.session.episode_id].join("_")]),"imdb"===app.config.fetcher.mode&&(ui.tv.bdwXHR&&"function"==typeof ui.tv.bdwXHR.abort&&ui.tv.bdwXHR.abort(),ui.tv.bdwXHR=$.get(app.config.api_keys.tmdb_url+"tv/"+ui.tv.tmdbid+"/season/"+ui.tv.session.season_id+"/episode/"+ui.tv.session.episode_number+"/images?api_key="+app.config.api_keys.tmdb,function(s){s&&s.stills instanceof Array&&app.history.order[0]&&app.history.order[0][0]&&app.history.order[0][0]==ui.tv.session.id&&(app.history.order[0][2]=app.config.api_keys.tmdb_src+"w185"+s.stills[0].file_path,app.history.save())},"json"))},construct:function(s){var e=void 0!==app.favs.list[s.id];$("#slider_tvshow.tvshow_"+s.id+" .js-add-favorite").click(function(){app.favs.toggle(s.id)}).toggleClass("infavs",e),s.trailer&&$("#slider_tvshow.tvshow_"+s.id+" .trailer").show().click(function(){ui.trailer.show(s.trailer)})},getTrailer:function(t){ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"tv/"+ui.tv.tmdbid+"/videos?api_key="+app.config.api_keys.tmdb,function(s){let e;s&&s.results.length&&((e=!!s.results[0].key&&"https://www.youtube.com/embed/"+s.results[0].key+"?autoplay=1")&&$("#slider_tvshow.tvshow_"+t.id+" .trailer").show().click(function(){ui.trailer.show(e)}),t.trailer=e)},"json")},handlers:{imdb:{get_structure:function(s){fetcher.fetch.tv_show(s.imdb,function(s,e){s&&(slider.hide(),utils.msgbox("Error fetching the TV Show"),logger.log(s))})},get_show_info:function(r){ui.tv.infoXHR&&"function"==typeof ui.tv.infoXHR.abort&&ui.tv.infoXHR.abort();let e,t;const i={get_tmdb_id:function(e){r.tmdbid?e():ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"search/tv?query="+encodeURIComponent(r.title)+"&api_key="+app.config.api_keys.tmdb,function(s){s&&s.results instanceof Array&&s.results.length&&(r.tmdbid=s.results[0].id,ui.tv.tmdbid=s.results[0].id,e())},"json")},load_info:function(d){ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"tv/"+r.tmdbid+"?api_key="+app.config.api_keys.tmdb,function(e){if(e){e.id,r.year=e.first_air_date.substr(0,4)+"-"+e.last_air_date.substr(0,4),r.synopsis=e.overview,r.runtime=e.episode_run_time&&e.episode_run_time[0]?e.episode_run_time[0]+" "+locale.translate("durationUnit"):"",r.genre=e.genres instanceof Array&&e.genres[0]&&e.genres[0].name||"",r.poster_big=app.config.api_keys.tmdb_src+"w500"+e.poster_path,r.backdrop=app.config.api_keys.tmdb_src+"w1280"+e.backdrop_path,r.seasons=e.seasons;const a=$("#slider_tvshow.tvshow_"+r.imdb+" .seasons"),n=$("#slider_tvshow.tvshow_"+r.imdb+" .js-seasons");a.html('<div class="scroller_cont"></div>'),n.html(""),n.on("change",function(){var s=$(this).find(":selected").data("id"),e=$(this).find(":selected").data("season_id");$(this).find(":selected").data("episode_num"),ui.tv.set_season(s,e),ui.tv.show_episode(s,e,1)});for(let s=0;s<e.seasons.length;s++){e.seasons[s].name;var t=e.seasons[s].season_number,i=app.config.api_keys.tmdb_src+"w500"+e.seasons[s].poster_path;a.children(".scroller_cont").append('<div class="row season" data-season="'+t+'" onclick="ui.tv.set_season('+r.imdb+", "+t+");ui.tv.show_episode("+r.imdb+", "+t+', 1);">'+locale.translate("season")+" "+t+"</div>"),n.append('<option value="'+t+'" data-id="'+r.imdb+'" data-season_id="'+t+'" data-episode_num="1">'+locale.translate("season")+" "+t+"</option>"),$("#slider_tvshow.tvshow_"+r.imdb+" .poster").attr("style",'background-image: url("'+i+'")').removeClass("fadein").addClass("fadein")}var s=r.poster_big,o=r.title.toLowerCase().replace(/\s\(\d{4}\)$/,"");utils.setMetas({title:utils.titles.itemTitle.replace("{{item_name}}",r.title),url:"https://popcorntimeonline.xyz/"+slugify(o+" "+r.year.substring(0,4))+".html?tmdb="+r.imdb,image:s})}d()},"json")},display_info:function(){$("#slider_tvshow.tvshow_"+r.imdb+" .fav-btn").click(function(){app.favs.toggle(r.imdb)}),$(".slider.tvshow_"+r.imdb+" .synopsis").html(r.synopsis).addClass("fadein"),$(".slider.tvshow_"+r.imdb+" .title_info.genre").html(r.genre),$(".slider.tvshow_"+r.imdb+" .title_info .year").html(r.year),$(".slider.tvshow_"+r.imdb+" .js-synopsis").html(r.synopsis),$(".slider.tvshow_"+r.imdb+" .movie-synopsis").html(r.synopsis),$(".slider.tvshow_"+r.imdb+" .js-genres").html(r.genre),$(".slider.tvshow_"+r.imdb+" .js-year").html(r.year),ui.tv.set_season(r.imdb,1),ui.tv.show_episode(r.imdb,1,1),$('#slider_tvshow .row.season[data-season="1"]').addClass("activated"),$('#slider_tvshow .row.season[data-season="0"]').remove(),$('#slider_tvshow .row.season[data-season="0"]').remove(),r.runtime&&$(".slider.tvshow_"+r.imdb+" .title_info .runtime").html(r.runtime).parent(".runtime_cont").show(),$(".slider.tvshow_"+r.imdb+" .js-runtime").html(r.runtime).parent(".runtime_cont").show(),r.trailer||ui.tv.getTrailer(r);let s=new Image;s.onload=function(){$("#slider_tvshow.tvshow_"+r.id+" .poster").css("background-image","url("+r.poster_big+")").addClass("fadein"),$("#slider_tvshow.tvshow_"+r.id+" .js-poster").css("background-image","-webkit-linear-gradient(rgba(0,0,0, 0) 0%,rgba(0,0,0, 1) 100%), url("+r.poster_big+")").addClass("fadein")},s.src=r.poster_big,s=new Image,s.onload=function(){$('<div class="backdrop_img"><div class="img" style="background-image:url('+r.backdrop+')">').appendTo("#slider_tvshow.tvshow_"+r.id+" .backdrop"),setTimeout(function(){$("#slider_tvshow .backdrop_img").addClass("fadein")},50)},s.src=r.backdrop}};r.synopsis&&r.runtime&&r.genre?setTimeout(i.display_info,100):(e=["get_tmdb_id","load_info","display_info"],(t=function(s){e.length<=(s=s||0)||i[e[s]](function(){t(++s)})})())},load_images:function(s){},load_actors:function(s){}},anime:{get_structure:function(s){fetcher.fetch.tv_show(s.imdb,function(s,e){s&&(slider.hide(),utils.msgbox("Error fetching the TV Show"),logger.log(s))})},get_show_info:function(r){ui.tv.infoXHR&&"function"==typeof ui.tv.infoXHR.abort&&ui.tv.infoXHR.abort();let e,t;const i={get_tmdb_id:function(e){r.tmdbid?e():ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"search/tv?query="+encodeURIComponent(r.title)+"&api_key="+app.config.api_keys.tmdb,function(s){s&&s.results instanceof Array&&s.results.length&&(r.tmdbid=s.results[0].id,ui.tv.tmdbid=s.results[0].id,e())},"json")},load_info:function(d){ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"tv/"+r.tmdbid+"?api_key="+app.config.api_keys.tmdb,function(e){if(e){e.id,r.year=e.first_air_date.substr(0,4)+"-"+e.last_air_date.substr(0,4),r.synopsis=e.overview,r.runtime=e.episode_run_time&&e.episode_run_time[0]?e.episode_run_time[0]+" "+locale.translate("durationUnit"):"",r.genre=e.genres instanceof Array&&e.genres[0]&&e.genres[0].name||"",r.poster_big=app.config.api_keys.tmdb_src+"w500"+e.poster_path,r.backdrop=app.config.api_keys.tmdb_src+"w1280"+e.backdrop_path,r.seasons=e.seasons;const a=$("#slider_tvshow.tvshow_"+r.imdb+" .seasons"),n=$("#slider_tvshow.tvshow_"+r.imdb+" .js-seasons");a.html('<div class="scroller_cont"></div>'),n.html(""),n.on("change",function(){var s=$(this).find(":selected").data("id"),e=$(this).find(":selected").data("season_id");$(this).find(":selected").data("episode_num"),ui.tv.set_season(s,e),ui.tv.show_episode(s,e,1)});for(let s=0;s<e.seasons.length;s++){e.seasons[s].name;var t=e.seasons[s].season_number,i=app.config.api_keys.tmdb_src+"w500"+e.seasons[s].poster_path;a.children(".scroller_cont").append('<div class="row season" data-season="'+t+'" onclick="ui.tv.set_season('+r.imdb+", "+t+");ui.tv.show_episode("+r.imdb+", "+t+', 1);">'+locale.translate("season")+" "+t+"</div>"),n.append('<option value="'+t+'" data-id="'+r.imdb+'" data-season_id="'+t+'" data-episode_num="1">'+locale.translate("season")+" "+t+"</option>"),$("#slider_tvshow.tvshow_"+r.imdb+" .poster").attr("style",'background-image: url("'+i+'")').removeClass("fadein").addClass("fadein")}var s=r.poster_big,o=r.title.toLowerCase().replace(/\s\(\d{4}\)$/,"");utils.setMetas({title:utils.titles.itemTitle.replace("{{item_name}}",r.title),url:"https://popcorntimeonline.xyz/"+slugify(o+" "+r.year.substring(0,4))+".html?tmdb="+r.imdb,image:s})}d()},"json")},display_info:function(){$("#slider_tvshow.tvshow_"+r.imdb+" .fav-btn").click(function(){app.favs.toggle(r.imdb)}),$(".slider.tvshow_"+r.imdb+" .synopsis").html(r.synopsis).addClass("fadein"),$(".slider.tvshow_"+r.imdb+" .title_info.genre").html("Anime"),$(".slider.tvshow_"+r.imdb+" .title_info .year").html(r.year),$(".slider.tvshow_"+r.imdb+" .js-synopsis").html(r.synopsis),$(".slider.tvshow_"+r.imdb+" .movie-synopsis").html(r.synopsis),$(".slider.tvshow_"+r.imdb+" .js-genres").html("Anime"),$(".slider.tvshow_"+r.imdb+" .js-year").html(r.year),ui.tv.set_season(r.imdb,1),ui.tv.show_episode(r.imdb,1,1),$('#slider_tvshow .row.season[data-season="1"]').addClass("activated"),$('#slider_tvshow .row.season[data-season="0"]').remove(),$('#slider_tvshow .row.season[data-season="0"]').remove(),r.runtime&&$(".slider.tvshow_"+r.imdb+" .title_info .runtime").html(r.runtime).parent(".runtime_cont").show(),$(".slider.tvshow_"+r.imdb+" .js-runtime").html(r.runtime).parent(".runtime_cont").show(),r.trailer||ui.tv.getTrailer(r);let s=new Image;s.onload=function(){$("#slider_tvshow.tvshow_"+r.id+" .poster").css("background-image","url("+r.poster_big+")").addClass("fadein"),$("#slider_tvshow.tvshow_"+r.id+" .js-poster").css("background-image","-webkit-linear-gradient(rgba(0,0,0, 0) 0%,rgba(0,0,0, 1) 100%), url("+r.poster_big+")").addClass("fadein")},s.src=r.poster_big,s=new Image,s.onload=function(){$('<div class="backdrop_img"><div class="img" style="background-image:url('+r.backdrop+')">').appendTo("#slider_tvshow.tvshow_"+r.id+" .backdrop"),setTimeout(function(){$("#slider_tvshow .backdrop_img").addClass("fadein")},50)},s.src=r.backdrop}};r.synopsis&&r.runtime&&r.genre?setTimeout(i.display_info,100):(e=["get_tmdb_id","load_info","display_info"],(t=function(s){e.length<=(s=s||0)||i[e[s]](function(){t(++s)})})())},load_images:function(s){},load_actors:function(s){}},cartoons:{get_structure:function(s){fetcher.fetch.tv_show(s.imdb,function(s,e){s&&(slider.hide(),utils.msgbox("Error fetching the TV Show"),logger.log(s))})},get_show_info:function(d){ui.tv.infoXHR&&"function"==typeof ui.tv.infoXHR.abort&&ui.tv.infoXHR.abort();let e,t;const i={get_tmdb_id:function(e){d.tmdbid?e():ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"search/tv?query="+encodeURIComponent(d.title)+"&api_key="+app.config.api_keys.tmdb,function(s){s&&s.results instanceof Array&&s.results.length&&(d.tmdbid=s.results[0].id,ui.tv.tmdbid=s.results[0].id,e())},"json")},load_info:function(n){ui.tv.infoXHR=$.get(app.config.api_keys.tmdb_url+"tv/"+d.tmdbid+"?api_key="+app.config.api_keys.tmdb,function(e){if(e){e.id,d.year=e.first_air_date.substr(0,4)+"-"+e.last_air_date.substr(0,4),d.synopsis=e.overview,d.runtime=e.episode_run_time&&e.episode_run_time[0]?e.episode_run_time[0]+" "+locale.translate("durationUnit"):"",d.genre=e.genres instanceof Array&&e.genres[0]&&e.genres[0].name||"",d.poster_big=app.config.api_keys.tmdb_src+"w500"+e.poster_path,d.backdrop=app.config.api_keys.tmdb_src+"w1280"+e.backdrop_path,d.seasons=e.seasons;const a=$("#slider_tvshow.tvshow_"+d.imdb+" .seasons");a.html('<div class="scroller_cont"></div>');for(let s=0;s<e.seasons.length;s++){e.seasons[s].name;var t=e.seasons[s].season_number,i=app.config.api_keys.tmdb_src+"w500"+e.seasons[s].poster_path;a.children(".scroller_cont").append('<div class="row season" data-season="'+t+'" onclick="ui.tv.set_season('+d.imdb+", "+t+");ui.tv.show_episode("+d.imdb+", "+t+', 1);">'+locale.translate("season")+" "+t+"</div>"),$("#slider_tvshow.tvshow_"+d.imdb+" .poster").attr("style",'background-image: url("'+i+'")').removeClass("fadein").addClass("fadein")}var s=d.poster_big,o=d.title.toLowerCase().replace(/\s\(\d{4}\)$/,"");utils.setMetas({title:utils.titles.itemTitle.replace("{{item_name}}",d.title),url:"https://popcorntimeonline.xyz/"+slugify(o+" "+d.year.substring(0,4))+".html?tmdb="+d.imdb,image:s})}n()},"json")},display_info:function(){$("#slider_tvshow.tvshow_"+d.imdb+" .fav-btn").click(function(){app.favs.toggle(d.imdb)}),$(".slider.tvshow_"+d.imdb+" .synopsis").html(d.synopsis).addClass("fadein"),$(".slider.tvshow_"+d.imdb+" .title_info.genre").html("Cartoons"),$(".slider.tvshow_"+d.imdb+" .title_info .year").html(d.year),ui.tv.set_season(d.imdb,1),ui.tv.show_episode(d.imdb,1,1),$('#slider_tvshow .row.season[data-season="1"]').addClass("activated"),$('#slider_tvshow .row.season[data-season="0"]').remove(),d.runtime&&$(".slider.tvshow_"+d.imdb+" .title_info .runtime").html(d.runtime).parent(".runtime_cont").show(),d.trailer||ui.tv.getTrailer(d);let s=new Image;s.onload=function(){$("#slider_tvshow.tvshow_"+d.id+" .poster").css("background-image","url("+d.poster_big+")").addClass("fadein"),$("#slider_tvshow.tvshow_"+d.id+" .js-poster").css("background-image","-webkit-linear-gradient(rgba(0,0,0, 0) 0%,rgba(0,0,0, 1) 100%), url("+d.poster_big+")").addClass("fadein")},s.src=d.poster_big,s=new Image,s.onload=function(){$('<div class="backdrop_img"><div class="img" style="background-image:url('+d.backdrop+')">').appendTo("#slider_tvshow.tvshow_"+d.id+" .backdrop"),setTimeout(function(){$("#slider_tvshow .backdrop_img").addClass("fadein")},50)},s.src=d.backdrop}};d.synopsis&&d.runtime&&d.genre?setTimeout(i.display_info,100):(e=["get_tmdb_id","load_info","display_info"],(t=function(s){e.length<=(s=s||0)||i[e[s]](function(){t(++s)})})())},load_images:function(s){},load_actors:function(s){}}}};